<h3>Edit page for <%= @list.name %></h3>

<%= form_with model: @list, url: user_list_path(@user, @list), local: true do |f| %>
    <%= f.label :name%>
    <%= f.text_field :name %><br><br>
    Choose recipes to add to list below.<br><br>
    <% Recipe.all.each do |recipe| %>
        <%= f.fields_for :recipes, recipe do |recipes_fields| %>
            <%= recipes_fields.check_box :included, {checked: @list.recipes.include?(recipe)}  %>
            <%= recipes_fields.label :"#{recipe.name}" %>
        <% end %><br>
    <% end %>
    Add any individual items with quantities below.<br><br>
    <% @list.additional_items.each do |additional_item| %>
        <%= f.fields_for :additional_items, additional_item do |additional_items_fields| %>
            <label> Item </label>
            <%= additional_items_fields.text_field :name, list: "item names" %> 
            <%= additional_items_fields.label :quantity %>
            <%= additional_items_fields.text_field :quantity %><br>
        <% end %><br>
    <% end %>
    <% 15.times do %>
        <%= f.fields_for :additional_items, @list.additional_items.build do |additional_items_fields| %>
            <label> Item </label>
            <%= additional_items_fields.text_field :name, list: "item names" %> 
            <datalist id="item names">
                <% Item.pluck(:name).each do |name| %>
                    <option value="<%= name %>">
                <% end %>
            </datalist>
            <%= additional_items_fields.label :quantity %>
            <%= additional_items_fields.text_field :quantity %><br>
        <% end %>
        <br>
    <% end %>



    <%= f.submit %>
<% end %>
<br><br>
<%= button_to "Delete List", user_list_path(@user, @list), method: :delete %>


